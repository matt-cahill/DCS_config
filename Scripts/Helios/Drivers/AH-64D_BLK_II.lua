-- export driver for AH-64D_BLK_II generated by Helios Profile Editor
local driver = { }
driver.selfName = "AH-64D_BLK_II"
driver.everyFrameArguments = {
  [402]="%0.1f",
  [403]="%0.1f",
  [404]="%0.1f",
  [405]="%0.1f",
  [406]="%0.1f",
  [407]="%0.1f",
  [408]="%0.1f",
  [409]="%0.1f",
  [410]="%0.1f",
  [411]="%0.1f",
  [412]="%0.1f",
  [413]="%0.1f",
  [414]="%0.1f",
  [415]="%0.1f",
  [416]="%0.1f",
  [417]="%0.1f",
  [418]="%0.1f",
  [419]="%0.1f",
  [420]="%0.1f",
  [421]="%0.1f",
  [422]="%0.1f",
  [423]="%0.1f",
  [424]="%0.1f",
  [425]="%0.1f",
  [426]="%0.1f",
  [427]="%0.1f",
  [428]="%0.1f",
  [429]="%0.1f",
  [430]="%0.1f",
  [431]="%0.1f",
  [432]="%0.1f",
  [433]="%0.1f",
  [434]="%0.1f",
  [435]="%0.1f",
  [436]="%0.1f",
  [437]="%0.1f",
  [438]="%0.1f",
  [439]="%0.1f",
  [440]="%0.1f",
  [441]="%0.1f",
  [442]="%0.1f",
  [443]="%0.1f",
  [444]="%0.1f",
  [445]="%0.1f",
  [446]="%0.1f",
  [447]="%0.1f",
  [448]="%0.1f",
  [469]="%.4f",
  [622]="%.4f",
  [623]="%.4f",
  [624]="%0.1f",
  [625]="%.4f",
  [626]="%.4f",
  [627]="%.4f",
  [636]="%.4f",
  [806]="%0.1f",
  [808]="%0.1f"
}
driver.arguments = {
  [10]="%.1f",
  [11]="%.1f",
  [12]="%.1f",
  [13]="%.1f",
  [14]="%.1f",
  [15]="%.1f",
  [16]="%.1f",
  [17]="%.1f",
  [18]="%.3f",
  [19]="%.3f",
  [20]="%.1f",
  [21]="%.1f",
  [22]="%.1f",
  [23]="%.1f",
  [24]="%.1f",
  [25]="%.1f",
  [26]="%0.1f",
  [27]="%.1f",
  [28]="%.1f",
  [29]="%.1f",
  [30]="%.1f",
  [31]="%.1f",
  [32]="%.1f",
  [33]="%.1f",
  [34]="%.1f",
  [35]="%.1f",
  [36]="%.1f",
  [37]="%.1f",
  [38]="%.1f",
  [39]="%.1f",
  [40]="%.1f",
  [41]="%.1f",
  [42]="%.1f",
  [43]="%.1f",
  [44]="%.1f",
  [45]="%.1f",
  [46]="%.1f",
  [47]="%.1f",
  [48]="%.1f",
  [49]="%.1f",
  [50]="%.1f",
  [51]="%.1f",
  [52]="%.3f",
  [53]="%.3f",
  [54]="%.1f",
  [55]="%.1f",
  [56]="%.1f",
  [57]="%.1f",
  [58]="%.1f",
  [59]="%.1f",
  [60]="%0.1f",
  [61]="%.1f",
  [62]="%.1f",
  [63]="%.1f",
  [64]="%.1f",
  [65]="%.1f",
  [66]="%.1f",
  [67]="%.1f",
  [68]="%.1f",
  [69]="%.1f",
  [70]="%.1f",
  [71]="%.1f",
  [72]="%.1f",
  [73]="%.1f",
  [74]="%.1f",
  [75]="%.1f",
  [76]="%.1f",
  [77]="%.1f",
  [78]="%.1f",
  [79]="%.1f",
  [80]="%.1f",
  [81]="%.1f",
  [82]="%.1f",
  [83]="%.1f",
  [84]="%.1f",
  [85]="%.1f",
  [86]="%.3f",
  [87]="%.3f",
  [88]="%.1f",
  [89]="%.1f",
  [90]="%.1f",
  [91]="%.1f",
  [92]="%.1f",
  [93]="%.1f",
  [94]="%0.1f",
  [95]="%.1f",
  [96]="%.1f",
  [97]="%.1f",
  [98]="%.1f",
  [99]="%.1f",
  [100]="%.1f",
  [101]="%.1f",
  [102]="%.1f",
  [103]="%.1f",
  [104]="%.1f",
  [105]="%.1f",
  [106]="%.1f",
  [107]="%.1f",
  [108]="%.1f",
  [109]="%.1f",
  [110]="%.1f",
  [111]="%.1f",
  [112]="%.1f",
  [113]="%.1f",
  [114]="%.1f",
  [115]="%.1f",
  [116]="%.1f",
  [117]="%.1f",
  [118]="%.1f",
  [119]="%.1f",
  [120]="%.3f",
  [121]="%.3f",
  [122]="%.1f",
  [123]="%.1f",
  [124]="%.1f",
  [125]="%.1f",
  [126]="%.1f",
  [127]="%.1f",
  [128]="%0.1f",
  [129]="%.1f",
  [130]="%.1f",
  [131]="%.1f",
  [132]="%.1f",
  [133]="%.1f",
  [134]="%.1f",
  [135]="%.1f",
  [136]="%.1f",
  [137]="%.1f",
  [138]="%.1f",
  [139]="%.1f",
  [140]="%.1f",
  [141]="%.1f",
  [142]="%.1f",
  [143]="%.1f",
  [144]="%.1f",
  [145]="%.1f",
  [146]="%0.1f",
  [147]="%0.1f",
  [148]="%.3f",
  [149]="%.3f",
  [150]="%.1f",
  [151]="%.1f",
  [152]="%.1f",
  [153]="%.1f",
  [154]="%0.1f",
  [155]="%0.1f",
  [156]="%0.1f",
  [157]="%0.1f",
  [158]="%.1f",
  [159]="%.1f",
  [160]="%.1f",
  [161]="%.1f",
  [162]="%.1f",
  [163]="%0.1f",
  [164]="%.1f",
  [165]="%.1f",
  [166]="%.1f",
  [167]="%.1f",
  [168]="%.1f",
  [169]="%.1f",
  [170]="%.1f",
  [171]="%.1f",
  [172]="%.1f",
  [173]="%.1f",
  [174]="%.1f",
  [175]="%.1f",
  [176]="%.1f",
  [177]="%.1f",
  [178]="%.1f",
  [179]="%.1f",
  [180]="%.1f",
  [181]="%.1f",
  [182]="%.1f",
  [183]="%.1f",
  [184]="%.1f",
  [185]="%.1f",
  [186]="%.1f",
  [187]="%.1f",
  [188]="%.1f",
  [189]="%.1f",
  [190]="%.1f",
  [191]="%.1f",
  [192]="%.1f",
  [193]="%.1f",
  [194]="%.1f",
  [195]="%.1f",
  [196]="%.1f",
  [197]="%.1f",
  [198]="%.1f",
  [199]="%.1f",
  [200]="%.1f",
  [201]="%.1f",
  [202]="%.1f",
  [203]="%.1f",
  [204]="%.1f",
  [205]="%.1f",
  [206]="%.1f",
  [207]="%.1f",
  [208]="%.1f",
  [209]="%.1f",
  [210]="%.1f",
  [211]="%.1f",
  [212]="%.1f",
  [213]="%.1f",
  [214]="%.1f",
  [215]="%.1f",
  [216]="%.1f",
  [217]="%.1f",
  [218]="%.1f",
  [219]="%.1f",
  [220]="%.1f",
  [221]="%.1f",
  [222]="%.1f",
  [223]="%.1f",
  [224]="%.1f",
  [225]="%.1f",
  [226]="%.1f",
  [227]="%.1f",
  [228]="%.1f",
  [229]="%.1f",
  [230]="%.1f",
  [231]="%.1f",
  [232]="%.1f",
  [233]="%.1f",
  [234]="%.1f",
  [235]="%.1f",
  [236]="%.1f",
  [237]="%.1f",
  [238]="%.1f",
  [239]="%.1f",
  [240]="%.1f",
  [241]="%.1f",
  [242]="%.1f",
  [243]="%.1f",
  [244]="%.1f",
  [245]="%.1f",
  [246]="%.1f",
  [247]="%.1f",
  [248]="%.1f",
  [249]="%.1f",
  [250]="%.1f",
  [251]="%.1f",
  [252]="%.1f",
  [253]="%.1f",
  [254]="%.1f",
  [255]="%.1f",
  [256]="%.1f",
  [257]="%.1f",
  [258]="%.1f",
  [259]="%.1f",
  [260]="%.1f",
  [261]="%.1f",
  [262]="%0.1f",
  [263]="%0.1f",
  [264]="%0.1f",
  [265]="%.3f",
  [266]="%.1f",
  [267]="%.1f",
  [268]="%.1f",
  [269]="%.1f",
  [270]="%0.1f",
  [271]="%0.1f",
  [272]="%0.1f",
  [273]="%.3f",
  [274]="%.1f",
  [275]="%.1f",
  [276]="%.1f",
  [277]="%.1f",
  [278]="%.3f",
  [279]="%.3f",
  [280]="%.3f",
  [281]="%0.1f",
  [282]="%.3f",
  [283]="%.3f",
  [284]="%.1f",
  [285]="%0.1f",
  [286]="%.1f",
  [287]="%0.1f",
  [288]="%.1f",
  [289]="%0.1f",
  [290]="%.1f",
  [291]="%0.1f",
  [292]="%.1f",
  [293]="%.1f",
  [294]="%.1f",
  [295]="%.1f",
  [296]="%0.1f",
  [297]="%.1f",
  [298]="%0.1f",
  [299]="%.1f",
  [300]="%0.1f",
  [301]="%.1f",
  [302]="%0.1f",
  [303]="%.1f",
  [304]="%.1f",
  [305]="%.1f",
  [306]="%.1f",
  [307]="%.1f",
  [308]="%.1f",
  [309]="%0.1f",
  [310]="%.1f",
  [311]="%.1f",
  [312]="%0.1f",
  [313]="%.1f",
  [314]="%0.1f",
  [315]="%0.1f",
  [316]="%.3f",
  [317]="%0.1f",
  [318]="%0.1f",
  [319]="%.1f",
  [320]="%.1f",
  [321]="%.1f",
  [322]="%.1f",
  [323]="%.1f",
  [324]="%.1f",
  [325]="%.1f",
  [326]="%0.1f",
  [327]="%.3f",
  [328]="%.3f",
  [329]="%.3f",
  [330]="%.3f",
  [331]="%.3f",
  [332]="%0.1f",
  [333]="%.1f",
  [334]="%.3f",
  [335]="%.3f",
  [336]="%.3f",
  [337]="%.3f",
  [338]="%.3f",
  [339]="%0.1f",
  [340]="%0.1f",
  [341]="%0.1f",
  [342]="%0.1f",
  [343]="%0.1f",
  [344]="%.3f",
  [345]="%.3f",
  [346]="%0.1f",
  [347]="%.1f",
  [348]="%.3f",
  [349]="%.3f",
  [350]="%.3f",
  [351]="%.3f",
  [352]="%.3f",
  [353]="%0.1f",
  [354]="%0.1f",
  [355]="%0.1f",
  [356]="%.1f",
  [357]="%0.1f",
  [358]="%.1f",
  [359]="%.1f",
  [360]="%0.1f",
  [361]="%.1f",
  [362]="%.1f",
  [363]="%0.1f",
  [364]="%.3f",
  [365]="%.3f",
  [366]="%.3f",
  [367]="%.1f",
  [368]="%.1f",
  [369]="%.1f",
  [370]="%.1f",
  [371]="%.1f",
  [372]="%.1f",
  [373]="%.1f",
  [374]="%.1f",
  [375]="%.3f",
  [376]="%.3f",
  [377]="%.3f",
  [378]="%.3f",
  [379]="%.3f",
  [380]="%0.1f",
  [381]="%0.1f",
  [382]="%0.1f",
  [383]="%0.1f",
  [384]="%0.1f",
  [385]="%.3f",
  [386]="%.3f",
  [387]="%0.1f",
  [388]="%.1f",
  [389]="%.3f",
  [390]="%.3f",
  [391]="%.3f",
  [392]="%.3f",
  [393]="%.3f",
  [394]="%.1f",
  [395]="%0.1f",
  [397]="%0.1f",
  [398]="%0.3f",
  [399]="%0.3f",
  [400]="%.1f",
  [401]="%0.1f",
  [449]="%.1f",
  [450]="%.1f",
  [451]="%.1f",
  [452]="%.1f",
  [453]="%.1f",
  [454]="%.1f",
  [455]="%.1f",
  [456]="%.1f",
  [457]="%.1f",
  [458]="%.1f",
  [459]="%.1f",
  [460]="%.1f",
  [461]="%.1f",
  [462]="%.1f",
  [463]="%.1f",
  [464]="%.1f",
  [465]="%.1f",
  [466]="%.1f",
  [467]="%.1f",
  [468]="%.1f",
  [477]="%.4f",
  [610]="%0.1f",
  [611]="%.3f",
  [612]="%.3f",
  [614]="%.1f",
  [615]="%.1f",
  [616]="%.1f",
  [617]="%.1f",
  [618]="%.1f",
  [619]="%.3f",
  [620]="%.1f",
  [621]="%.3f",
  [628]="%0.3f",
  [629]="%0.3f",
  [633]="%0.3f",
  [634]="%0.1f",
  [796]="%0.1f",
  [799]="%0.1f",
  [801]="%0.1f",
  [802]="%0.1f",
  [803]="%0.1f",
  [804]="%0.1f",
  [805]="%.1f",
  [807]="%.1f"
}
-- Exports.Lua from Helios AH-64D interface

function driver.processHighImportance(mainPanelDevice)
	-- Send Altimeter Values	
	helios.send(2051, string.format("%0.4f;%0.4f;%0.4f", mainPanelDevice:get_argument_value(606), mainPanelDevice:get_argument_value(605), mainPanelDevice:get_argument_value(479)))
	helios.send(2059, string.format("%0.2f;%0.2f;%0.3f", mainPanelDevice:get_argument_value(607), mainPanelDevice:get_argument_value(608), mainPanelDevice:get_argument_value(609)))		
end

function driver.processLowImportance(mainPanelDevice)

    -- structured data
    li = helios.parseIndication(15) -- 15 Pilot Keyboard Unit
    if li then
        helios.send(2080, string.format("%s", helios.ensureString(li.Standby_text):gsub(":", "!")))
    end
    li = helios.parseIndication(14) -- 14 CP/G Keyboard Unit
    if li then
        helios.send(2081, string.format("%s", helios.ensureString(li.Standby_text):gsub(":", "!")))
    end
	if mainPanelDevice:get_argument_value(610) == -1.0 then
		-- clear the Chaff, Flare, and threat display if the CMWS is off
		helios.send(2082, "")
		helios.send(2083, "")
		for ii = 2084,2093 do helios.send(ii, "0.0") end
	else
		li = helios.parseIndication(24) -- 24 CMWS Unit
		if li then
			if li["#83#"]  and li["#83#"] ~= "" then -- Chaff & Flares
				helios.send(2082, string.format("%1s  %s", helios.ensureString(li["#83#"]), helios.ensureString(li["#85#"])))
				helios.send(2083, string.format("%1s  %s", helios.ensureString(li["#84#"]), helios.ensureString(li["#86#"])))
				-- The CMWS flags are held in variables which either are declared or not, and when the exist, they are an empty string
				helios.send(2084, string.format("%0.1f", li["#87#"] and 1 or 0)) -- Ready (this seems to have an inverse which is #89#)
				helios.send(2085, string.format("%0.1f", li["#88#"] and 1 or 0)) -- Dispense (this seems to have an inverse which is #90#)
				helios.send(2086, string.format("%0.1f", li["#17#"] and 1 or 0)) -- top left arrow display is #17#-#23#
				helios.send(2087, string.format("%0.1f", li["#10#"] and 1 or 0)) -- top right arrow display is #10#-#16#
				helios.send(2088, string.format("%0.1f", li["#24#"] and 1 or 0)) -- bottom left arrow display is #24#-#30#
				helios.send(2089, string.format("%0.1f", li["#31#"] and 1 or 0)) -- bottom right arrow display is #31#-#37#
				helios.send(2090, string.format("%0.1f", li["#38#"] and 1 or 0)) -- top yellow arrow
				helios.send(2091, string.format("%0.1f", li["#39#"] and 1 or 0)) -- left yellow arrow
				helios.send(2092, string.format("%0.1f", li["#40#"] and 1 or 0)) -- bottom yellow arrow
				helios.send(2093, string.format("%0.1f", li["#41#"] and 1 or 0)) -- right yellow arrow		
			elseif li["#42#"] and li["#42#"] ~= ""  then -- CMWS Status
				helios.send(2082, string.format("%s", helios.ensureString(li["#42#"])))
				helios.send(2083, string.format("%s", helios.ensureString(li["#43#"])))
				-- Suppress the threat direction when CMWS is in test mode
				for ii = 2084,2093 do helios.send(ii, "0.0") end
			else
			end
		end
	end

end
return driver